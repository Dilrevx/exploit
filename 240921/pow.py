import hashlib
from itertools import product
import re
import string
import requests



answerUrl = 'https://app.toutiao.com?url=http%3A%2F%2F47.121.200.18'

questionUrl = "http://35.221.152.10:23334/"


def main():
    html = requests.get(questionUrl).text

    '''
demo: Proof of work: sha256('Jn4zPlGJ + 
'''

    regexp = "sha256\('(.+?) "
    challenge = re.search(regexp, html).group(1)

    def crackPow(challenge: str):
        prefix = "000000"
        pow_answer = 0

        while True:
            input_str = challenge + str(pow_answer)
            hash_object = hashlib.sha256(input_str.encode())
            hashed_str = hash_object.hexdigest()

            if hashed_str.startswith(prefix):
                print(hashed_str)
                return str(pow_answer)

            pow_answer += 1
    print(html)
    print(challenge)
    solution = crackPow(challenge)
    print(solution)
    req = requests.post(questionUrl, 
              data={'pow_answer': solution,
                    'url': answerUrl})

    print(req.text)

    if 'out of date' not in req.text:
        exit(0)

while True:
    main()

